{% extends "layout.html" %}

{% block title %}Filtrar Países{% endblock %}

{% block content %}
    <h1>Filtrar Países</h1>
    <p>Puedes usar uno o varios filtros a la vez. Deja los campos en blanco para ignorarlos.</p>

    <style>
        .filter-form { 
            display: flex; 
            gap: 20px; align-items: 
            flex-end; background-color: #f9f9f9; 
            padding: 20px; 
            border-radius: 8px; 
            margin-bottom: 20px;
        }
        .filter-group { 
            display: flex; 
            flex-direction: column; 
        }
        .filter-group label { 
            margin-bottom: 5px; 
            font-weight: bold; 
        }
        .filter-group input, 
        .filter-group select { 
            padding: 8px; 
        }
    </style>

    <form method="GET" action="/filtrar" class="filter-form">
        <div class="filter-group">
            <label for="continente">Continente:</label>
            <select id="continente" name="continente">
                <option value="">Todos</option>
                {% for c in continentes %}
                <option value="{{ c }}" {% if c == filtros_actuales.continente %}selected{% endif %}>{{ c }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="filter-group">
            <label>Población:</label>
            <input type="number" name="pob_min" placeholder="Mínima" value="{{ filtros_actuales.pob_min }}">
            <input type="number" name="pob_max" placeholder="Máxima" value="{{ filtros_actuales.pob_max }}">
        </div>

        <div class="filter-group">
            <label>Superficie (km²):</label>
            <input type="number" name="sup_min" placeholder="Mínima" value="{{ filtros_actuales.sup_min }}">
            <input type="number" name="sup_max" placeholder="Máxima" value="{{ filtros_actuales.sup_max }}">
        </div>
        
        <button type="submit">Filtrar</button>
        <a href="/filtrar">Limpiar Filtros</a>
    </form>

    <h2>Resultados del Filtro</h2>
    {% if paises %}
        <p>{{ paises|length }} países encontrados.</p>
        <table>
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Continente</th>
                    <th>Población</th>
                    <th>Superficie (km²)</th>
                </tr>
            </thead>
            <tbody>
                {% for pais in paises %}
                <tr>
                    <td>{{ pais.nombre }}</td>
                    <td>{{ pais.continente }}</td>
                    <td>{{ "{:,}".format(pais.poblacion) }}</td>
                    <td>{{ "{:,}".format(pais.superficie) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No se encontraron países que coincidan con los filtros aplicados.</p>
    {% endif %}

{% endblock %}